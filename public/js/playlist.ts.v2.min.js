!function(t,s){jPlayerPlaylist=function(s,e,i){var l=this;this.current=0,this.loop=!1,this.shuffled=!1,this.removing=!1,this.cssSelector=t.extend({},this._cssSelector,s),this.options=t.extend(!0,{keyBindings:{next:{key:221,fn:function(){l.next()}},previous:{key:219,fn:function(){l.previous()}},shuffle:{key:83,fn:function(){l.shuffle()}}},stateClass:{shuffled:"jp-state-shuffled"}},this._options,i),this.playlist=[],this.original=[],this.traxsource={options:{holdPlayerHide:!1,isFirstPlay:!0}},this._initPlaylist(e),this.cssSelector.details=this.cssSelector.cssSelectorAncestor+" .jp-details",this.cssSelector.playlist=this.cssSelector.cssSelectorAncestor+" .jp-playlist",this.cssSelector.next=this.cssSelector.cssSelectorAncestor+" .jp-next",this.cssSelector.previous=this.cssSelector.cssSelectorAncestor+" .jp-previous",this.cssSelector.shuffle=this.cssSelector.cssSelectorAncestor+" .jp-shuffle",this.cssSelector.shuffleOff=this.cssSelector.cssSelectorAncestor+" .jp-shuffle-off",this.options.cssSelectorAncestor=this.cssSelector.cssSelectorAncestor,this.options.repeat=function(t){l.loop=t.jPlayer.options.loop},t(this.cssSelector.jPlayer).bind(t.jPlayer.event.ready,function(){l._init()}),t(this.cssSelector.jPlayer).bind(t.jPlayer.event.ended,function(){l.next()}),t(this.cssSelector.jPlayer).bind(t.jPlayer.event.play,function(){t(this).jPlayer("pauseOthers")}),t(this.cssSelector.jPlayer).bind(t.jPlayer.event.resize,function(s){s.jPlayer.options.fullScreen?t(l.cssSelector.details).show():t(l.cssSelector.details).hide()}),t(this.cssSelector.previous).click(function(t){t.preventDefault(),l.previous(),l.blur(this)}),t(this.cssSelector.next).click(function(t){t.preventDefault(),l.next(),l.blur(this)}),t(this.cssSelector.shuffle).click(function(s){s.preventDefault(),l.shuffled&&t(l.cssSelector.jPlayer).jPlayer("option","useStateClassSkin")?l.shuffle(!1):l.shuffle(!0),l.blur(this)}),t(this.cssSelector.shuffleOff).click(function(t){t.preventDefault(),l.shuffle(!1),l.blur(this)}).hide(),this.options.fullScreen||t(this.cssSelector.details).hide(),t(this.cssSelector.playlist+" ul").empty(),this._createItemHandlers(),t(this.cssSelector.jPlayer).jPlayer(this.options)},jPlayerPlaylist.prototype={_cssSelector:{jPlayer:"#jquery_jplayer_1",cssSelectorAncestor:"#jp_container_1"},_options:{playlistOptions:{autoPlay:!1,loopOnPrevious:!1,shuffleOnLoop:!0,enableRemoveControls:!1,displayTime:"slow",addTime:"fast",removeTime:"fast",shuffleTime:"slow",itemClass:"jp-playlist-item",freeGroupClass:"jp-free-media",freeItemClass:"jp-playlist-item-free",removeItemClass:"jp-playlist-item-remove"}},option:function(t,e){if(e===s)return this.options.playlistOptions[t];switch(this.options.playlistOptions[t]=e,t){case"enableRemoveControls":this._updateControls();break;case"itemClass":case"freeGroupClass":case"freeItemClass":case"removeItemClass":this._refresh(!0),this._createItemHandlers()}return this},_init:function(){var t=this;this._refresh(function(){t.options.playlistOptions.autoPlay?t.play(t.current):t.select(t.current)})},_initPlaylist:function(s){this.current=0,this.shuffled=!1,this.removing=!1,this.original=t.extend(!0,[],s),this._originalPlaylist()},_originalPlaylist:function(){var s=this;this.playlist=[],t.each(this.original,function(t){s.playlist[t]=s.original[t]})},_refresh:function(s){var e=this;if(s&&!t.isFunction(s))t(this.cssSelector.playlist+" ul").empty(),t.each(this.playlist,function(s){t(e.cssSelector.playlist+" ul").append(e._createListItem(e.playlist[s]))}),this._updateControls();else{var i=t(this.cssSelector.playlist+" ul").children().length?this.options.playlistOptions.displayTime:0;t(this.cssSelector.playlist+" ul").slideUp(i,function(){var i=t(this);t(this).empty(),t.each(e.playlist,function(t){i.append(e._createListItem(e.playlist[t]))}),e._updateControls(),t.isFunction(s)&&s(),e.playlist.length?t(this).slideDown(e.options.playlistOptions.displayTime):t(this).show()})}},_createListItem:function(t){var s,e,i,l,a,r,n,o=this;return n=t.hasOwnProperty("ref_id")?" pl-trk-"+t.ref_id:"",s='<li name="'+o.playlist.length+'" class="pl-trk-'+t.track_id+n+" pl-ttl-"+t.title_id+'">',s+='<div class="'+this.options.playlistOptions.itemClass+'">\n',e=renderArtLabLinks(t.artist,t.label,!0,!0),s+='<div class="thumb"><div class="thumb-cont"><img src="'+t.thumb+'" /></div>\n',s+='</div><div class="tar-cont"><div class="tk-title ellip">'+t.title+"\n",s+='</div><div class="tk-artist ellip">'+e.al.join(", ")+"\n",s+='</div></div><div class="label ellip">'+e.ll+"\n",s+='</div><div class="r-date">'+t.r_date+"\n",isNaN(t.price)?(i="buy-cont",t.preorder&&t.preorder.hasOwnProperty("int")&&10==t.preorder["int"].toString().length&&(now=Math.floor(Date.now()/1e3),pubDate=t.preorder["int"],pubDate>now&&(i="buy-cont pre-ord")),t.bitrate?t.price.hasOwnProperty("zip")?(l=t.price.zip,a=", bitrate: 9"):t.price.hasOwnProperty("stems")?(l=t.price.stems,a=", bitrate: 4"):1==t.bitrate&&t.price.hasOwnProperty("hbr")?(l=t.price.hbr,a=", bitrate: 1"):2==t.bitrate&&t.price.hasOwnProperty("wav")?(l=t.price.wav,a=", bitrate: 2"):(l=t.price.wav,a=", bitrate: 3"):t.price.hasOwnProperty("wav")?(l=t.price.wav,a=", bitrate: 2"):(l=t.price.hbr,a=", bitrate: 1"),t.bought&&(i+=" bought"),r='<div class="'+i+'">',r+='<a href="javascript:void(0)" class="com-buy" data-cart="{title_id:'+t.title_id+",track_id:"+t.track_id+a+'}">$<span class="price">'+l+"</span></a>",r+='<a href="javascript:void(0)" class="cart-alt player"></a></div>'):r='<div class="alb-only">Album Only</div>',s+='</div><div class="utils">',s+=r,s+='<a href="javascript:;" class="'+this.options.playlistOptions.removeItemClass+'"></a></div>',s+="</div></li>\n\n"},_createItemHandlers:function(){var s=this;t(this.cssSelector.playlist).off("click","div."+this.options.playlistOptions.itemClass).on("click","div."+this.options.playlistOptions.itemClass,function(e){if(!t(e.target).is("a")&&!t(e.target).parent().is("a")){var i=t(this).parent().index();s.current!==i?s.play(i):t(s.cssSelector.jPlayer).jPlayer("play"),s.blur(this)}}),t(this.cssSelector.playlist).off("click","a."+this.options.playlistOptions.removeItemClass).on("click","a."+this.options.playlistOptions.removeItemClass,function(e){e.preventDefault();var i=t(this).parent().parent().parent().index();s.remove(i),s.blur(this)})},_updateControls:function(){this.options.playlistOptions.enableRemoveControls?t(this.cssSelector.playlist+" ."+this.options.playlistOptions.removeItemClass).show():t(this.cssSelector.playlist+" ."+this.options.playlistOptions.removeItemClass).hide()},_highlight:function(e){this.playlist.length&&e!==s&&(t(this.cssSelector.playlist+" .jp-playlist-current").removeClass("jp-playlist-current"),t(this.cssSelector.playlist+" li:nth-child("+(e+1)+")").addClass("jp-playlist-current").find(".jp-playlist-item").addClass("jp-playlist-current"))},setPlaylist:function(t){this._initPlaylist(t),this._init()},add:function(s,e){t(this.cssSelector.playlist+" ul").append(this._createListItem(s)),this._updateControls(),this.original.push(s),this.playlist.push(s),e?this.play(this.playlist.length-1):1===this.original.length&&this.select(0)},remove:function(e,i,l){var a=this;return l===s&&(l=!1),e===s?(this._initPlaylist(TX.initPlaylist),TX.isMobile&&(TX.mobileDummyPlLoaded=!0),this._refresh(function(){t(a.cssSelector.jPlayer).jPlayer("clearMedia")}),!0):this.removing?!1:(e=0>e?a.original.length+e:e,e>=0&&e<this.playlist.length&&(this.removing=!0,t(this.cssSelector.playlist+" li:nth-child("+(e+1)+")").slideUp(this.options.playlistOptions.removeTime,function(){t(this).remove(),a.original.splice(e,1),a.playlist.splice(e,1),a.original.length?e===a.current?(a.current=e<a.original.length?a.current:a.original.length-1,a.select(a.current)):e<a.current&&a.current--:a.traxsource.options.holdPlayerHide||l||clearPlaylist(),updatePlaylistCount(),a.removing=!1,a.original.length&&!i&&a.refreshNames()})),!0)},select:function(s){s=0>s?this.original.length+s:s,s>=0&&s<this.playlist.length?(this.current=s,this._highlight(s),t(this.cssSelector.jPlayer).jPlayer("setMedia",this.playlist[this.current])):this.current=0},play:function(e){e=0>e?this.original.length+e:e,e>=0&&e<this.playlist.length?this.playlist.length&&(this.select(e),t(this.cssSelector.jPlayer).jPlayer("play")):e===s&&t(this.cssSelector.jPlayer).jPlayer("play"),this.traxsource.options.isFirstPlay&&(this.traxsource.options.isFirstPlay=!1)},pause:function(){t(this.cssSelector.jPlayer).jPlayer("pause")},next:function(){var t=this.current+1<this.playlist.length?this.current+1:0;this.loop?0===t&&this.shuffled&&this.options.playlistOptions.shuffleOnLoop&&this.playlist.length>1?this.shuffle(!0,!0):this.play(t):t>0&&this.play(t)},previous:function(){var t=this.current-1>=0?this.current-1:this.playlist.length-1;(this.loop&&this.options.playlistOptions.loopOnPrevious||t<this.playlist.length-1)&&this.play(t)},shuffle:function(e,i){var l=this;e===s&&(e=!this.shuffled),(e||e!==this.shuffled)&&t(this.cssSelector.playlist+" ul").slideUp(this.options.playlistOptions.shuffleTime,function(){l.shuffled=e,e?l.playlist.sort(function(){return.5-Math.random()}):l._originalPlaylist(),l._refresh(!0),i||!t(l.cssSelector.jPlayer).data("jPlayer").status.paused?l.play(0):l.select(0),t(this).slideDown(l.options.playlistOptions.shuffleTime)})},blur:function(s){t(this.cssSelector.jPlayer).jPlayer("option","autoBlur")&&t(s).blur()},scan:function(){var s=this,e=!1;plreplace=new Array,t.each(t(this.cssSelector.playlist+" ul li"),function(i,l){plreplace[i]=s.original[t(l).attr("name")],e||s.current!==parseInt(t(l).attr("name"),10)||(s.current=i,e=!0),t(l).attr("name",i)}),this.original=plreplace,this._originalPlaylist()},refreshNames:function(){t.each(t(this.cssSelector.playlist+" ul li"),function(s,e){t(e).attr("name",s)})},add2playlist:function(s,e){var l=this;if(s){if(0!=l.playlist.length||e||(e=!0),e&&showPlayer(),l.playlist.length){for(i=0;i<l.playlist.length;i++)s==l.playlist[i].track_id&&l.remove(i);l.playlist.length>=TX.plLimit&&l.remove(0)}t.ajax({url:TX.scriptsHost+"/scripts/playlist.php",type:"GET",data:"tracks="+s+getUUID,success:function(i){var a,r,n,o;a=TX.getEvalObj(t(i).find("data").text()),r=a[0],r.bitrate=TX.currentBitrate,l.add(r,e),o=t(i).find("cpd").text(),o.length&&(n=TX.getEvalObj(o),n&&t.extend(TX.cartsPLStats,n),updateSinglePlaylistBuyBtn(s,!0)),updatePlaylistCount(),enablePlaylistLinks()}}),l.checkMobileFirstPlayDummy()}},addTracks2playlist:function(s,e,i){if(!s)return!1;var l,a,r,n,o,c,p,h=null,u=0,y=null,d=this,f={},m=[];if(showLoader(),a=t("#tsjp1").data("jPlayer").status.paused,0!=d.playlist.length||e||(e=!0),e&&showPlayer(),d.playlist.length){for(d.option("removeTime",0),d.traxsource.options.holdPlayerHide=!0,p=0;p<d.playlist.length;p++)f[d.playlist[p].track_id]=p;for(o=s.length,c=0;o--;)f.hasOwnProperty(s[c].track_id)&&m.push(f[s[c].track_id]),c++;for(m.reverse(),o=m.length,c=0;o--;)d.remove(m[c],!0)&&m[c],c++;if(l=d.playlist.length+s.length,l>TX.plLimit)for(u=l-TX.plLimit,o=0;u>o;o++)d.remove(0,!0);d.traxsource.options.holdPlayerHide=!1,d.refreshNames(),null!=h&&d.pause(),d.option("removeTime","fast")}for(o=s.length+1,c=0,o>TX.plLimit&&(o=TX.plLimit+1);--o;)r=s[c],r.bitrate=TX.currentBitrate,d.add(r),c++;n=d.checkMobileFirstPlayDummy(),1==e?y=n?0:d.playlist.length-s.length:null==h||a||(y=h),null!=y&&setTimeout(function(){d.play(y)},300),i&&(t.extend(TX.cartsPLStats,i),updatePlaylistBuyButtons()),hideLoader(),updatePlaylistCount(),enablePlaylistLinks()},addTitle2playlist:function(s,e,i){var l=this;if(s){var a="";a=i&&!isNaN(parseInt(i))?"&gf="+i:"",t.ajax({url:TX.scriptsHost+"/scripts/playlist.php",type:"GET",data:"titles="+s+a+getUUID,success:function(s){var i,a,r;i=TX.getEvalObj(t(s).find("data").text()),r=t(s).find("cpd").text(),r.length&&(a=TX.getEvalObj(r)),l.addTracks2playlist(i,e,a)}})}},getPlayAllTracks:function(s,e,i){var l,a=this,r="";if(r=i&&!isNaN(parseInt(i))?"&gf="+i:"",t(s).data("tracks"))l="tracks="+t(s).data("tracks");else{if(!t(s).data("titles"))return!1;l="titles="+t(s).data("titles")}t.ajax({url:TX.scriptsHost+"/scripts/playlist.php",type:"GET",data:l+r+getUUID,success:function(s){var i,l,r;i=TX.getEvalObj(t(s).find("data").text()),r=t(s).find("cpd").text(),r.length&&(l=TX.getEvalObj(r)),a.addTracks2playlist(i,e,l)}})},enablePlayButtons:function(s,e,i,l,a){var r=this,n="",o=0;n="track"==i?"trid":"tid",t(s).click(function(){if(!TX.playlistAddBusy){switch(TX.playlistAddBusy=!0,setTimeout(function(){TX.playlistAddBusy=!1},500),r.traxsource.options.isFirstPlay&&TX.useDummyPlay&&t(this).hasClass("com-play")&&r.play(0),e){case"LL":o=t(this).parent().hasClass("play-fly")?t(this).parent().parent().parent().data(n):t(this).parent().hasClass("img-fly")?t(this).parent().parent().parent().data(n):t(this).parent().parent().data(n);break;case"TG":o=t(this).parent().parent().parent().data(n);break;case"TL":o=t(this).parent().hasClass("play-fly")?t(this).parent().parent().parent().data(n):t(this).parent().parent().data(n);break;case"TP":o=t("#tpTrid").val()}"track"==i?r.add2playlist(o,l):r.addTitle2playlist(o,l,a),t(this).addClass("played")}})},enablePlayAll:function(s){var e,i=this,l=!1;t(".genre-id").length>0&&(l=t(".genre-id").data("gid")),t(".com-play-all, .com-pl-all, .play-count",s).click(function(s){s.stopImmediatePropagation(),TX.playlistAddBusy||(TX.playlistAddBusy=!0,setTimeout(function(){TX.playlistAddBusy=!1},1e3),i.traxsource.options.isFirstPlay&&TX.useDummyPlay&&i.play(0),e=!t(this).hasClass("com-pl-all"),i.getPlayAllTracks(t(this),e,l))})},checkMobileFirstPlayDummy:function(){var t=this;return TX.mobileDummyPlLoaded?(t.remove(0,!1,!0),TX.mobileDummyPlLoaded=!1,!0):!1}}}(jQuery);